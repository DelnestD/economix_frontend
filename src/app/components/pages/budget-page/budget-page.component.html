<div
  class="w-[100vw] h-[100vh] bg-[black] bg-opacity-20 fixed top-0 left-0"
  *ngIf="showModal !== ''"
  tabindex="-1"
></div>
<app-form-transaction
  *ngIf="showModal === 'transaction'"
  [createNew]="true"
  [accounts]="accounts"
  [budgets]="budgets"
  (close)="setShowModal('')"
></app-form-transaction>
<app-form-account
  *ngIf="showModal === 'account'"
  [createNew]="true"
  (close)="setShowModal('')"
></app-form-account>
<app-form-budget
  *ngIf="showModal === 'budget'"
  [createNew]="true"
  (close)="setShowModal('')"
></app-form-budget>

<div class="flex justify-center mt-5">
  <button class="btnAdd" (click)="setShowModal('transaction')">
    Nouvelle transaction
  </button>
</div>
<div class="flex justify-between px-32">
  <div class="flex items-center mb-5">
    <p class="title">Mon compte</p>
    <button type="button" class="btnAddRound" (click)="setShowModal('account')">
      +
    </button>
  </div>
  <div class="flex items-center mb-5">
    <button type="button" class="btnAddRound" (click)="setShowModal('budget')">
      +
    </button>
    <p class="title">Mon budget</p>
  </div>
</div>

<div class="w-full flex static">
  <div class="side border-r-4 border-r-secondary">
    <cdk-accordion>
      @for (account of accounts; track account.id; let index = $index) {
      <cdk-accordion-item
        #accordionItem="cdkAccordionItem"
        role="button"
        tabindex="0"
        [attr.id]="'accordion-header-' + index"
        [attr.aria-expanded]="accordionItem.expanded"
        [attr.aria-controls]="'accordion-body-' + index"
      >
        <div (click)="accordionItem.toggle()">
          <app-budget-structure
            [description]="account.title"
            [total]="totalAccount[index]"
          />
        </div>
        <div
          class="accordion"
          role="region"
          [style.display]="accordionItem.expanded ? '' : 'none'"
          [attr.id]="'accordion-body-' + index"
          [attr.aria-labelledby]="'accordion-header-' + index"
        >
          @for (transaction of transactionsAccount[index]; track transaction.id)
          {
          <app-transaction
            [dateTransaction]="transaction.date"
            [description]="transaction.title"
            [amount]="transaction.amount"
          />
          }
        </div>
      </cdk-accordion-item>
      }
    </cdk-accordion>
  </div>

  <div class="side">
    <div>
      <cdk-accordion>
        @for (budget of budgets; track budget.id; let index = $index) {
        <cdk-accordion-item
          #accordionItem="cdkAccordionItem"
          role="button"
          tabindex="0"
          [attr.id]="'accordion-header-' + index"
          [attr.aria-expanded]="accordionItem.expanded"
          [attr.aria-controls]="'accordion-body-' + index"
        >
          <div (click)="accordionItem.toggle()">
            <app-budget-structure
              [description]="budget.title"
              [total]="totalBudget[index]"
            />
          </div>
          <div
            class="accordion"
            role="region"
            [style.display]="accordionItem.expanded ? '' : 'none'"
            [attr.id]="'accordion-body-' + index"
            [attr.aria-labelledby]="'accordion-header-' + index"
          >
            @for (transaction of transactionsBudget[index]; track
            transaction.id) {
            <app-transaction
              [dateTransaction]="transaction.date"
              [description]="transaction.title"
              [amount]="transaction.amount"
            />
            }
          </div>
        </cdk-accordion-item>
        }
      </cdk-accordion>
    </div>
  </div>
</div>
